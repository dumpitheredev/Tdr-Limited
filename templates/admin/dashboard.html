{% extends "base/layout.html" %}

{% block content %}
<div class="container-fluid">
    <!-- Welcome Message -->
    <div class="mb-3">
        <h2 class="welcome-heading mb-3">Hello {{ session.name }}!</h2>
    </div>

    <!-- Announcements Section -->
    {% if announcements %}
    <div class="card mb-4 border-0 shadow-sm">
        <div class="card-header bg-white py-3">
            <h3 class="h5 mb-0" style="color: #191970;">
                <i class="bi bi-megaphone me-2"></i>Announcements
            </h3>
        </div>
        <div class="card-body">
            <div class="list-group list-group-flush">
                {% for announcement in announcements %}
                    <div class="announcement-item mb-3 p-3 border-start border-4 {{ 'border-warning' if announcement.is_maintenance else 'border-primary' }}">
                        <h5 class="{{ 'text-warning' if announcement.is_maintenance else 'text-primary' }}">
                            {% if announcement.is_maintenance %}
                            <i class="bi bi-exclamation-triangle me-2"></i>
                            {% endif %}
                            {{ announcement.title }}
                        </h5>
                        <p id="announcement-{{ loop.index }}" class="announcement-content {{ 'text-warning' if announcement.is_maintenance else '' }} mb-2">{{ announcement.content }}</p>
                        <button onclick="toggleAnnouncement('announcement-{{ loop.index }}')" class="btn btn-sm btn-outline-secondary">Read more</button>
                        <small class="text-muted">Posted on {{ announcement.created_at.strftime('%Y-%m-%d') }}</small>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Management Cards Grid -->
    <div class="row g-4">
        {% set cards = [
        {
        'title': 'User Management',
        'icon': 'bi-people-fill',
        'url': url_for('admin.user_management'),
        'bg_class': 'bg-light-purple'
        },
        {
        'title': 'Student Management',
        'icon': 'bi-mortarboard',
        'url': url_for('admin.student_management'),
        'bg_class': 'bg-light-pink'
        },
        {
        'title': 'Company Management',
        'icon': 'bi-building',
        'url': url_for('admin.company_management'),
        'bg_class': 'bg-light-green'
        },
        {
        'title': 'Class Management',
        'icon': 'bi-easel',
        'url': url_for('admin.class_management'),
        'bg_class': 'bg-light-gray'
        },
        {
        'title': 'Instructor Management',
        'icon': 'bi-person-video3',
        'url': url_for('admin.instructor_management'),
        'bg_class': 'bg-light-yellow'
        },
        {
        'title': 'Enrollment Management',
        'icon': 'bi-person-plus-fill',
        'url': url_for('admin.enrollment_management'),
        'bg_class': 'bg-light-blue'
        },
        {
        'title': 'View Attendance',
        'icon': 'bi-eye',
        'url': url_for('admin.attendance_view'),
        'bg_class': 'bg-light-yellow-soft'
        },
        {
        'title': 'Mark Attendance',
        'icon': 'bi-calendar-check',
        'url': url_for('admin.mark_attendance'),
        'bg_class': 'bg-light-pink-soft'
        },
        {
        'title': 'View Archive',
        'icon': 'bi-archive',
        'url': url_for('admin.view_archive'),
        'bg_class': 'bg-light-orange'
        }
        ] %}

        {% for card in cards %}
        <div class="col-md-6 col-lg-4">
            <a href="{{ card.url }}" class="text-decoration-none">
                <div class="card management-card h-100 border-0 {{ card.bg_class }}">
                    <div class="card-body d-flex flex-column align-items-center justify-content-center text-center p-4">
                        <i class="bi {{ card.icon }} display-4 mb-3"></i>
                        <h3 class="h5 mb-0">{{ card.title }}</h3>
                    </div>
                </div>
            </a>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Function to toggle announcement content expansion
    function toggleAnnouncement(id) {
        const element = document.getElementById(id);
        const button = element.nextElementSibling;
        
        if (!element.classList.contains('expanded')) {
            element.classList.add('expanded');
            button.textContent = 'Show less';
        } else {
            element.classList.remove('expanded');
            button.textContent = 'Read more';
        }
    }
</script>
<style>
    .announcement-content {
        max-height: 3rem;
        overflow: hidden;
        transition: max-height 0.3s ease;
    }
    
    .announcement-content.expanded {
        max-height: 20rem;
    }
</style>
{% endblock %}